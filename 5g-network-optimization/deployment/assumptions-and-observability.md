# Runtime Assumptions and Observability Coverage

## Local Docker Compose Stack
- **Services** – The top-level compose file builds and runs the NEF emulator, ML service, Prometheus, and Grafana on a shared `5g-network` bridge network, exposing ports 8080, 5050, 9090, and 3000 respectively.【F:5g-network-optimization/docker-compose.yml†L1-L65】
- **Configuration knobs** – Runtime tuning relies on environment variables. The NEF emulator and ML service both expect `A3_HYSTERESIS_DB` and `A3_TTT_S`; the ML stack also reads `ML_LOCAL` to decide whether to build the service locally and to pass through to the emulator.【F:5g-network-optimization/docker-compose.yml†L8-L33】 Grafana’s admin password defaults to `admin`, which should be overridden in production deployments.【F:5g-network-optimization/docker-compose.yml†L52-L61】
- **Inter-service dependencies** – The ML service is hard-wired to call the NEF emulator at `http://nef-emulator:80` inside the compose network. Prometheus scrapes both workloads using their in-cluster names, and Grafana depends on Prometheus being reachable at `prometheus:9090` when its data source is configured.【F:5g-network-optimization/docker-compose.yml†L30-L58】

## NEF Emulator Development Compose
- **Optional data stores** – The nested compose file for the NEF emulator provisions Postgres, MongoDB, and optional admin UIs when the `debug`/`dev` profiles are enabled. Credentials and connection details are injected through a shared `.env` file that must define items such as `MONGO_USER`, `MONGO_PASSWORD`, SMTP settings, NGINX host/ports, and the external Docker network name (`EXTERNAL_NET`).【F:5g-network-optimization/services/nef-emulator/docker-compose.yml†L3-L119】
- **Reverse proxy** – An NGINX container fronts the FastAPI backend and depends on the database containers; certificates are expected under `./nginx/certs`, with helper scripts to generate self-signed certificates on startup.【F:5g-network-optimization/services/nef-emulator/docker-compose.yml†L89-L115】

## Kubernetes Manifests
- **NEF emulator** – The deployment runs a single replica of the NEF emulator image, exposing port 80 and relying on baked-in defaults for `SERVER_NAME`, `SERVER_HOST`, `A3_HYSTERESIS_DB`, and `A3_TTT_S`. No external secrets are referenced, so per-environment overrides would need to be provided via ConfigMaps or Secrets before production use.【F:5g-network-optimization/deployment/kubernetes/nef-emulator.yaml†L1-L43】
- **ML service** – Two replicas run with HTTP health probes against `/api/health`, resource requests/limits, and environment variables for `NEF_API_URL` (pointing at the cluster service) and `MODEL_PATH`. A transient `emptyDir` volume supplies the `/app/models` directory, so any persisted model must be mounted separately in production.【F:5g-network-optimization/deployment/kubernetes/ml-service.yaml†L1-L58】 An optional ingress is pre-declared for `ml-service.example.com` but requires a controller and DNS mapping to function.【F:5g-network-optimization/deployment/kubernetes/ml-service.yaml†L73-L89】
- **Monitoring stack** – Prometheus and Grafana deployments mount ConfigMaps that embed their configurations and dashboards. Prometheus scrapes itself plus the ML service and NEF emulator over their cluster service endpoints, while Grafana is pre-provisioned to load dashboards from the mounted ConfigMaps and sets the admin password inline.【F:5g-network-optimization/deployment/kubernetes/prometheus-grafana.yaml†L1-L663】

## Monitoring and Observability Assets
- **Prometheus scrape coverage** – Both the Docker Compose and Kubernetes configurations target only the NEF emulator, ML service, and Prometheus’ own metrics endpoint. Additional infrastructure (databases, message queues, etc.) are not monitored out of the box.【F:5g-network-optimization/monitoring/prometheus/prometheus.yml†L1-L27】【F:5g-network-optimization/deployment/kubernetes/prometheus-grafana.yaml†L24-L38】
- **Exposed metrics** – Project documentation notes that the NEF emulator exports counters (e.g., `nef_handover_decisions_total`, `nef_request_duration_seconds`) and the ML service exports drift, error rate, CPU, and memory gauges; these form the basis of the provided Grafana dashboards.【F:5g-network-optimization/monitoring/README.md†L25-L42】
- **Grafana dashboards** – The bundled dashboard surfaces prediction throughput, latency percentiles, antenna selection rates, model confidence, data drift, and resource usage, aligning with the metrics exposed by the services.【F:5g-network-optimization/deployment/kubernetes/prometheus-grafana.yaml†L62-L553】

## Outstanding Gaps and Assumptions
- **Secrets management** – Sensitive values (database passwords, SMTP credentials, Grafana admin password) are currently defined via environment variables or inline defaults. Production deployments should replace these with Secrets or a vault-backed mechanism.【F:5g-network-optimization/docker-compose.yml†L52-L61】【F:5g-network-optimization/services/nef-emulator/docker-compose.yml†L39-L107】
- **Persistent storage** – The ML service expects models under `/app/models` but only receives a temporary `emptyDir`; similarly, development databases rely on Docker volumes but no Kubernetes PersistentVolumes are defined.【F:5g-network-optimization/deployment/kubernetes/ml-service.yaml†L51-L58】【F:5g-network-optimization/services/nef-emulator/docker-compose.yml†L7-L37】
- **Limited telemetry scope** – No alerting rules, logging aggregation, or tracing configuration is supplied. Prometheus’ configuration contains placeholders for alertmanagers and rule files that must be populated to enable automated incident response.【F:5g-network-optimization/monitoring/prometheus/prometheus.yml†L7-L17】【F:5g-network-optimization/deployment/kubernetes/prometheus-grafana.yaml†L12-L22】
- **External dependencies** – The NEF emulator’s development stack assumes reachability of SMTP services and externally managed Docker networks (via `EXTERNAL_NET`), plus DNS/TLS settings for the reverse proxy. These dependencies must be provisioned in the target environment.【F:5g-network-optimization/services/nef-emulator/docker-compose.yml†L71-L119】
