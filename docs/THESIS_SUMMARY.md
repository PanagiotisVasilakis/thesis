# Thesis Project Summary

## Main Goal
The 5G Network Optimization project demonstrates how advanced handover algorithms can be applied in a reproducible testbed.  A 3GPP‑compliant Network Exposure Function (NEF) emulator emits mobility events for multiple UEs while a machine learning (ML) service learns from historical traces to predict the best serving cell.  By containerising both services we ensure results can be reproduced across different machines.  The overall objective is to balance coverage and quality of service by dynamically combining deterministic heuristics with ML‑driven insights【F:README.md†L1-L14】.

## Implemented Components
- **NEF Emulator** – FastAPI application that exposes REST endpoints to create UEs, retrieve movement state and trigger handovers.  The implementation lives in `services/nef-emulator/backend/app/`.  It bundles several mobility models and path‑loss calculations so it can simulate realistic radio conditions.  When ML support is disabled, it falls back to the pure A3 rule for deterministic behaviour.  The asynchronous design lets us schedule thousands of events per second without blocking other operations.
- **ML Service** – Lightweight Flask API offering `/api/predict` and `/api/train` routes.  It loads or trains the `LightGBMSelector` model on demand, persists the model to disk and exposes metrics for accuracy and request latency.  Training data is gathered from the NEF emulator or from prerecorded traces.  The service relies on a LightGBM classifier and can optionally tune hyperparameters during startup by setting `LIGHTGBM_TUNE=1`【F:README.md†L50-L50】.
- **Monitoring Stack** – Prometheus scrapes metrics from both services and Grafana dashboards visualise throughput, latency and model accuracy【F:5g-network-optimization/monitoring/README.md†L1-L21】.  Alerts can be configured to detect performance regressions during experiments, giving immediate feedback when tuning the ML model or A3 parameters.
- **Docker & Kubernetes** – `docker-compose.yml` spins up the NEF emulator, ML service and monitoring stack for local development.  Kubernetes manifests under `deployment/` replicate the same setup in a cluster for scale testing and CI pipelines【F:README.md†L31-L37】.  Images are built with multi-stage Dockerfiles so the runtime environment stays slim and consistent across setups.

## Handover Technique
`HandoverEngine` orchestrates the decision flow for every UE event.  When a mobility update arrives it first checks whether ML mode is enabled via the `ML_HANDOVER_ENABLED` variable or automatically if at least three antennas exist.  The engine then either loads the persisted `AntennaSelector` and requests a prediction or evaluates the `A3EventRule`.  The selected antenna ID is passed to `NetworkStateManager.apply_handover_decision` which updates the UE state and increments counters exposed to Prometheus.  Retries are attempted if no suitable antenna is found in the initial step【F:5g-network-optimization/services/nef-emulator/backend/app/app/handover/engine.py†L16-L62】【F:5g-network-optimization/services/nef-emulator/backend/app/app/handover/engine.py†L60-L98】.

## A3 Rule-Based Logic
`A3EventRule` accumulates measurements of the reference signal received power (RSRP) for the serving and neighbouring cells.  The rule checks whether the target cell’s RSRP exceeds the serving cell by `A3_HYSTERESIS_DB`.  If so, a timer is started and the condition must hold for `A3_TTT_S` seconds.  Any violation resets the timer.  Once both thresholds are met the event is raised and a handover is initiated【F:5g-network-optimization/services/nef-emulator/backend/app/app/handover/a3_rule.py†L1-L23】.

## ML-Based Logic
The `LightGBMSelector` class extends `AntennaSelector` and uses a LightGBM classifier to learn from location, movement and signal metrics for each UE.  Features include latitude, longitude, speed, normalised direction and the current antenna’s RSRP and SINR.  Training is performed with optional validation and early stopping as shown in the implementation【F:5g-network-optimization/services/ml-service/ml_service/app/models/lightgbm_selector.py†L45-L116】.  The resulting model is exported with `joblib` and reloaded at startup.  Predictions are served in real time through the Flask API and can be logged to assess feature importance and accuracy.  The training workflow relies on `collect_training_data.py` to query the NEF emulator and save samples which are then uploaded via `/api/train`.  This approach keeps the ML implementation decoupled from the emulator while allowing incremental retraining.

## Enterprise Standards
The radio propagation layer mirrors enterprise standards.  Antenna models rely on TR 38.901 path‑loss formulas such as ABG and Close‑In for realistic link budget calculations【F:5g-network-optimization/services/nef-emulator/docs/antenna_and_path_loss.md†L1-L28】.  Mobility patterns like Linear, Random Waypoint and Manhattan Grid are implemented according to the same specification to emulate common deployment scenarios【F:5g-network-optimization/services/nef-emulator/backend/app/app/mobility_models/README.md†L1-L30】.  These standards ensure the synthetic dataset approximates real-world radio conditions so that conclusions from experiments generalise to production networks.

## Testing & Coverage
`scripts/run_tests.sh` installs the required system packages, installs Python dependencies along with the ML service itself and then executes `pytest --cov` to gather coverage results under `CI-CD_reports/coverage_<timestamp>.txt`【F:scripts/run_tests.sh†L1-L16】.  The unit tests build a synthetic dataset via `generate_synthetic_training_data` and validate training as well as prediction accuracy in `test_model_training_and_prediction`【F:5g-network-optimization/services/ml-service/tests/test_model.py†L1-L30】【F:5g-network-optimization/services/ml-service/tests/test_model.py†L31-L45】.  Typical accuracy in those tests is around 85% and all 144 tests must pass, resulting in approximately 83% coverage across the repository.

---
Additional references can be found in [GETTING_STARTED](../5g-network-optimization/leftover_docks/GETTING_STARTED.md), the [Monitoring README](../5g-network-optimization/monitoring/README.md) and [Antenna & Path Loss documentation](../5g-network-optimization/services/nef-emulator/docs/antenna_and_path_loss.md).
